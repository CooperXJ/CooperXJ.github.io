<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"cooperxj.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="记录一些学习笔记、小说、随笔">
<meta property="og:type" content="website">
<meta property="og:title" content="Cooper Notes">
<meta property="og:url" content="http://cooperxj.github.io/page/2/index.html">
<meta property="og:site_name" content="Cooper Notes">
<meta property="og:description" content="记录一些学习笔记、小说、随笔">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Cooper">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://cooperxj.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Cooper Notes</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Cooper Notes</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">obey rules</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://cooperxj.github.io/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/BeanFactoryPostProcessor/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cooper">
      <meta itemprop="description" content="记录一些学习笔记、小说、随笔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cooper Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/BeanFactoryPostProcessor/" class="post-title-link" itemprop="url">BeanFactoryPostProcessor</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-07 08:43:47" itemprop="dateCreated datePublished" datetime="2022-01-07T08:43:47+08:00">2022-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-17 18:14:56" itemprop="dateModified" datetime="2022-01-17T18:14:56+08:00">2022-01-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/BeanFactoryPostProcessor/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/BeanFactoryPostProcessor/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>828</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="BeanFactoryPostProcessor"><a href="#BeanFactoryPostProcessor" class="headerlink" title="BeanFactoryPostProcessor"></a>BeanFactoryPostProcessor</h3><p>BeanFactory的后置处理器</p>
<p><font color=red>生效时机：在BeanFactory标准初始化之后调用，来定制和修改BeanFactory的内容 ，所有的Bean定义已经保存加载到BeanFactory，但是Bean的实例还未进行创建</font></p>
<p>流程：</p>
<ol>
<li><p> ioc容器创建对象</p>
</li>
<li><p>invokeBeanFactoryPostProcessors(beanFactory);执行BeanFactoryPostProcesor</p>
<p> 如何找到所有的BeanFactoryPostProcessor并执行他们的方法：</p>
<pre><code> 1. 直接在BeanFactory中找到所有类型时BeanFactoryPostProcessor的组件并执行他们的方法
 2. 在初始化创建其他组件前面执行
</code></pre>
</li>
</ol>
<h3 id="BeanDefinitionRegistryPostProcessor"><a href="#BeanDefinitionRegistryPostProcessor" class="headerlink" title="BeanDefinitionRegistryPostProcessor"></a>BeanDefinitionRegistryPostProcessor</h3><p>是BeanFactoryPostProcessor的子类</p>
<p>postProcessorBeanDefinitionRegistry()</p>
<p><font color=red>生效时机：在所有bean定义的信息==将要==被加载，bean实例还未创建的时候</font></p>
<p>因此生效 时机应该是在BeanFactoryPostProcessor之前</p>
<p>利用BeanDefinitionRegistryPostProcessor给容器中再额外添加一些组件</p>
<p>流程：</p>
<pre><code>1. ioc创建对象
2. refresh（）——&gt;invokeBeanFactoryPostProcessors(beanFactory)
3. 从容器中获取到所有的BeanDefinitionRegistryPostProcessor组件
 1. 依次触发所有的PostProcessorBeanDefinitionRegistry()方法
 2. 再来触发postProcessBeanFactory()方法
4. 再来从容器中找到BeanFactoryPostProcessor组件，然后依次触发PostProcessorBeanFactory（）方法
</code></pre>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://cooperxj.github.io/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/Transactional/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cooper">
      <meta itemprop="description" content="记录一些学习笔记、小说、随笔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cooper Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/Transactional/" class="post-title-link" itemprop="url">Transactional</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-07 08:43:47" itemprop="dateCreated datePublished" datetime="2022-01-07T08:43:47+08:00">2022-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-17 18:15:39" itemprop="dateModified" datetime="2022-01-17T18:15:39+08:00">2022-01-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/Transactional/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/Transactional/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><ol>
<li><p>@EnableTransactionManagement</p>
<p>利用TransactionManagementConfigurationSelector给容器中会导入两个组件</p>
<ul>
<li>AutoProxyRegister</li>
<li>ProxyTransactionManagementConfiguration</li>
</ul>
<p>导入流程如下：</p>
<ol>
<li><p>首先根据adviceMode判断类型</p>
<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210330083104.png" alt="image-20210330083058910"></p>
</li>
<li><p>由于EnableTransactionManagement是</p>
</li>
</ol>
<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210330083205.png" alt="image-20210330083203182"></p>
<p>因此会自动导入上述两个组件</p>
</li>
<li><p>AutoProxyRegister：给容器中注册一个InfrastructureAdvisorAutoProxyCreator组件</p>
<p>InfrastructureAdvisorAutoProxyCreator该组件的作用在于：</p>
<p>利用后置处理器机制在对象创建以后，包装对象，返回一个代理对象（增强器，和AOP中的增强器作用一样），代理对象执行方法利用拦截器链进行调用</p>
<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210330084218.png" alt="image-20210330084214278"></p>
</li>
<li><p>ProxyTransactionManagementConfiguration作用</p>
<ol>
<li><p>给容器中注册事务增强器</p>
<p> 事务增强器要用事务注解的信息：AnnotationTransactionAttributeSource解析事务注解</p>
<ol>
<li>根据 不同的注解类型调用不同的事务注解</li>
</ol>
 <img src="/Users/cooper/Library/Application Support/typora-user-images/image-20210330084650053.png" alt="image-20210330084650053" style="zoom:50%;" />

<ol start="2">
<li><p>调用事务注解</p>
<img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210330084803.png" alt="image-20210330084757042" style="zoom:50%;" />

<ol start="2">
<li>事务拦截器</li>
</ol>
</li>
</ol>
</li>
</ol>
<pre><code>TransactionInterceptor：保存了事务属性信息，事务管理器

他是一个MethodIntercept

在执行目标方法的时候执行拦截器链

事物拦截器：

 1.  先获取事务相关属性

 2.  再获取PlatformTransactionManager，如果事先没有添加指定任何TransactionManager,

     最终会从容器中按照类型获取一个PlatformTransactionManager

     所以说我们可以直接在IOC容器中直接注册一个PlatformTransactionManager是可以直接使用的，因为最后找不到都回去容器中找对应类型的Bean

     &lt;img src=&quot;https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210330085716.png&quot; alt=&quot;image-20210330085709877&quot; style=&quot;zoom:50%;&quot; /&gt;

3. 执行目标方法

   如果异常，并且添加了事务注解，那么获取到事务管理器之后就会利用事务管理回滚操作

   如果正常，利用事务管理器对事物进行提交

   ![image-20210330090829103](https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210330090837.png)

   ![image-20210330091133277](https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210330091134.png)

   **正常**：

   ![image-20210330091223867](https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210330091225.png)

   **异常**：

   ![image-20210330091012000](https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210330091016.png)

   ​    

   
</code></pre>
</li>
</ol>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://cooperxj.github.io/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/spring%E5%AE%B9%E5%99%A8%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cooper">
      <meta itemprop="description" content="记录一些学习笔记、小说、随笔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cooper Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/spring%E5%AE%B9%E5%99%A8%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/" class="post-title-link" itemprop="url">Spring容器的生命周期</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-07 08:43:47" itemprop="dateCreated datePublished" datetime="2022-01-07T08:43:47+08:00">2022-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-27 22:24:32" itemprop="dateModified" datetime="2021-08-27T22:24:32+08:00">2021-08-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/spring%E5%AE%B9%E5%99%A8%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/spring%E5%AE%B9%E5%99%A8%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="BeanFactory的创建及预准备工作"><a href="#BeanFactory的创建及预准备工作" class="headerlink" title="BeanFactory的创建及预准备工作"></a>BeanFactory的创建及预准备工作</h2><h3 id="spring容器的refresh-【创建刷新】"><a href="#spring容器的refresh-【创建刷新】" class="headerlink" title="spring容器的refresh()【创建刷新】"></a>spring容器的refresh()【创建刷新】</h3><h4 id="prepareRefresh-刷新前的预处理"><a href="#prepareRefresh-刷新前的预处理" class="headerlink" title="prepareRefresh()刷新前的预处理"></a>prepareRefresh()刷新前的预处理</h4><ol>
<li><p>initPropertySources()</p>
<p>初始化一些属性的设置，子类自定义个性化的属性设置方法</p>
</li>
<li><p>getEnvironment().validateRequiredProperties()</p>
<p>校验属性的合法性等</p>
</li>
<li><p>earlyApplicationEvents = new LinkedHashSet&lt; ApplicationEvent &gt;();</p>
<p>保存容器的一些早期事件</p>
</li>
</ol>
<h4 id="obtainFreshBeanFactory-获取BeanFactory"><a href="#obtainFreshBeanFactory-获取BeanFactory" class="headerlink" title="obtainFreshBeanFactory();获取BeanFactory"></a>obtainFreshBeanFactory();获取BeanFactory</h4><ol>
<li><p>refreshBeanFactory()</p>
<p>刷新【创建】BeanFactory</p>
<p>设置了一个this.beanFactory = new DefaultListableBeanFactory();</p>
<p>设置id</p>
</li>
<li><p>getBeanFactory()</p>
<p>返回刚才GenericApplicationContext创建的BeanFactory对象</p>
</li>
<li><p>将创建的BeanFactory【DefaultListableBeanFactory】返回</p>
</li>
</ol>
<h4 id="prepareBeanFactory-beanFactory-BeanFactory的预准备工作（BeanFactory进行一些设置）"><a href="#prepareBeanFactory-beanFactory-BeanFactory的预准备工作（BeanFactory进行一些设置）" class="headerlink" title="prepareBeanFactory(beanFactory);BeanFactory的预准备工作（BeanFactory进行一些设置）"></a>prepareBeanFactory(beanFactory);BeanFactory的预准备工作（BeanFactory进行一些设置）</h4><ol>
<li><p>设置BeanFactory的类加载器、支持表达式解析器</p>
</li>
<li><p>添加部分BeanPostProcessor【ApplicationContextAwareProcessor】</p>
</li>
<li><p>设置忽略的自动装配接口，例如EnvironmentAware、EmbeddedValueResolverAware、xxx</p>
</li>
<li><p>注册可以解析的自动装配，我们能直接在任何组件中自动注入：BeanFactory、ResourceLoader、ApplicationEventPublisher 、ApplicationContext</p>
</li>
<li><p>添加BeanPostProcessor【ApplicationListenerDetector】</p>
</li>
<li><p>添加编译时的AspectJ</p>
</li>
<li><p>给BeanFactory中注册一些能用的组件</p>
<p>environment【ConfigurableEnvironment】</p>
<p>systemProperties【Map&lt; String,Object &gt;】</p>
<p>systemEnviroment【Map&lt; String,Object &gt;】</p>
</li>
</ol>
<h4 id="postProcessBeanFactory-beanFactory-；BeanFactory准备工作完成后进行的一些后置处理工作"><a href="#postProcessBeanFactory-beanFactory-；BeanFactory准备工作完成后进行的一些后置处理工作" class="headerlink" title="postProcessBeanFactory(beanFactory)；BeanFactory准备工作完成后进行的一些后置处理工作"></a>postProcessBeanFactory(beanFactory)；BeanFactory准备工作完成后进行的一些后置处理工作</h4><ol>
<li>子类通过重写这个方法来在BeanFactory创建并预准备完成以后做进一步的设置</li>
</ol>
<hr>
<h4 id="invokeBeanFactoryPostProcessors-beanFactory-；执行BeanFactoryPostProcessor；"><a href="#invokeBeanFactoryPostProcessors-beanFactory-；执行BeanFactoryPostProcessor；" class="headerlink" title="invokeBeanFactoryPostProcessors(beanFactory)；执行BeanFactoryPostProcessor；"></a>invokeBeanFactoryPostProcessors(beanFactory)；执行BeanFactoryPostProcessor；</h4><p><font color=red>主要就是对BeanFactory里面的bean做一些修改操作，使得里面的Bean满足自己的需求</font></p>
<p>BeanFactoryPostProcessor：BeanFactory的后置处理器。在BeanFactory标准初始化之后执行</p>
<ol>
<li><p>执行BeanFactoryPostProcessor的方法</p>
<p>先执行BeanDefinitionRegistryPostProcessor</p>
<ol>
<li><p>获取所有的BeanDefinitionRegistryPostProcessor</p>
</li>
<li><p>先执行实现了PriorityOrdered优先级接口的BeanDefinitionRegistryPostProcessor</p>
<p>PostProcessor.postProcessBeanDefinitionRegistry（registry）</p>
</li>
<li><p>在执行实现了Ordered顺序接口的BeanDefinitionRegistry（registry）</p>
<p>PostProcessor.postProcessBeanDefinitionRegistry（registry）</p>
</li>
<li><p>最后执行没有实现任何优先级或者是顺序接口的BeanDefinitionRegistryPostProcessor</p>
<p>PostProcessor.postProcessBeanDefinitionRegistry（registry）</p>
</li>
</ol>
<p>再执行BeanFactoryPostProcessor的方法</p>
<ol>
<li><p>获取所有的BeanDefinitionRegistryPostProcessor</p>
</li>
<li><p>先执行实现了PriorityOrdered优先级接口的BeanDefinitionRegistryPostProcessor</p>
<p>PostProcessor.postProcessBeanDefinitionRegistry（registry）</p>
</li>
<li><p>在执行实现了Ordered顺序接口的BeanDefinitionRegistry（registry）</p>
<p>PostProcessor.postProcessBeanDefinitionRegistry（registry）</p>
</li>
<li><p>最后执行没有实现任何优先级或者是顺序接口的BeanDefinitionRegistryPostProcessor</p>
<p>PostProcessor.postProcessBeanDefinitionRegistry（registry）</p>
</li>
</ol>
</li>
</ol>
<hr>
<h4 id="registerBeanPostProcessors-beanFactory-注册BeanPostProcessor（Bean的后置处理器），拦截Bean的创建过程"><a href="#registerBeanPostProcessors-beanFactory-注册BeanPostProcessor（Bean的后置处理器），拦截Bean的创建过程" class="headerlink" title="registerBeanPostProcessors(beanFactory) 注册BeanPostProcessor（Bean的后置处理器），拦截Bean的创建过程"></a>registerBeanPostProcessors(beanFactory) 注册BeanPostProcessor（Bean的后置处理器），拦截Bean的创建过程</h4><p>不同接口类型的BeanPostProcessor在Bean创建前后执行的时机是不一样的</p>
<p>BeanPostProcessor、DestructionAwareBeanPostProcessor、InstantiationAwareBeanPostProcessor、</p>
<p>SmartInstantiationAwareBeanPostProcessor、MergedBeanDefinitionPostProcessor【internalPostProcessors】</p>
<ol>
<li><p>先获取所有的BeanPostProcess</p>
<p>后置处理器默认度可以通过PriorityOrdered、Ordered接口来执行优先级</p>
</li>
<li><p>先注册PriorityOrdered优先级接口的BeanPostProcessor</p>
<p>把每一个BeanPostProcessor添加到BeanFactory中</p>
<p>beanFactory.addBeanPostProcessor(postProcessor)</p>
</li>
<li><p>再注册Ordered接口的BeanPostProcessor</p>
</li>
<li><p>然后注册没有实现任何优先级接口的BeanPostProcessor</p>
</li>
<li><p>最终注册MergedBeanDefinitionPostProcessor</p>
</li>
<li><p>注册一个ApplicationListenerDetector在Bean创建完成后检查是否是ApplicationListener；</p>
<p>如果是则加入到容器中</p>
<p>applicationContext.addApplicationListener((ApplicationListener&lt;?&gt; bean));</p>
</li>
</ol>
<hr>
<h4 id="initMessageSource-初始化MessageSource组件（做国际化功能、消息绑定、消息解析）"><a href="#initMessageSource-初始化MessageSource组件（做国际化功能、消息绑定、消息解析）" class="headerlink" title="initMessageSource() 初始化MessageSource组件（做国际化功能、消息绑定、消息解析）"></a>initMessageSource() 初始化MessageSource组件（做国际化功能、消息绑定、消息解析）</h4><ol>
<li><p>获取BeanFactory</p>
</li>
<li><p>看容器中是否有id为messageSource的，类型是MessageSource的组件</p>
<p>如果有赋值给messageSource，如果没有自己创建一个DelegatingMessageSource</p>
<p>MessageSource：取出国际化配置文件中的某个key的值，能按照区域信息获取</p>
</li>
<li><p>把创建好的MessageSource创建在容器中，以后获取国际化配置文件的值的时候，可以自动注入MessageSource</p>
<p>BeanFactory.registerSingleton(MESSAGE_SOURCE_BEAN_NAME,this.messageSource);</p>
<p>MessageSource.String getMessage(String code,Object[] agrs,String defaultMessage)</p>
</li>
</ol>
<hr>
<h4 id="initApplicationEventMulticaster-初始化事件派发器"><a href="#initApplicationEventMulticaster-初始化事件派发器" class="headerlink" title="initApplicationEventMulticaster() 初始化事件派发器"></a>initApplicationEventMulticaster() 初始化事件派发器</h4><ol>
<li>获取BeanFactory</li>
<li>从BeanFactory中获取applicationEventMulticaster的ApplicationEventMulticaster</li>
<li>如果上一步没有配置，则会自动创建一个SimpleApplicationMulticaster</li>
<li>将创建的ApplicationEventMulticaster添加到BeanFactory中，以后其他组件直接自动注入</li>
</ol>
<hr>
<h4 id="onRefresh-留给子容器（子类）"><a href="#onRefresh-留给子容器（子类）" class="headerlink" title="onRefresh() 留给子容器（子类）"></a>onRefresh() 留给子容器（子类）</h4><ol>
<li>子类重写这个方法，在容器刷新的时候可以自定义逻辑</li>
</ol>
<hr>
<h4 id="registerListener-给容器中所有将项目里面的ApplicationListener注册进来"><a href="#registerListener-给容器中所有将项目里面的ApplicationListener注册进来" class="headerlink" title="registerListener()  给容器中所有将项目里面的ApplicationListener注册进来"></a>registerListener()  给容器中所有将项目里面的ApplicationListener注册进来</h4><ol>
<li><p>从容器中拿到所有的ApplicationListener</p>
</li>
<li><p>将每个监听器派发到事件派发器中</p>
<p>getApplicationEventMulticaster().addApplicationListenerBean(listenerBeanName)</p>
</li>
<li><p>派发之前步骤产生的事件</p>
</li>
</ol>
<hr>
<h4 id="finishBeanFactoryInitialization-beanFactory-初始化所有剩下的单实例Bean"><a href="#finishBeanFactoryInitialization-beanFactory-初始化所有剩下的单实例Bean" class="headerlink" title="finishBeanFactoryInitialization(beanFactory) 初始化所有剩下的单实例Bean"></a>finishBeanFactoryInitialization(beanFactory) 初始化所有剩下的单实例Bean</h4><ol>
<li><p>beanFactory.preInstantiateSingletons() 初始化后剩下的单实例bean</p>
<ol>
<li><p>获取容器中的所有Bean，依次进行初始化和创建对象</p>
</li>
<li><p>获取Bean的定义信息；RootBeanDefinition</p>
</li>
<li><p>Bean不是抽象的，是单实例的，是懒加载的</p>
<ol>
<li><p>判断是否是FactoryBean,是否是实现FactoryBean接口的Bean,如果是则利用创建工厂Bean的方法对Bean进行创建</p>
</li>
<li><p>不是工厂的Bean，利用getBean(beanName)创建对象</p>
<ol>
<li><p>getBean(beanName)</p>
<p>Ioc.getBean()</p>
</li>
<li><p>doGetBean(name，null,null,false)</p>
</li>
<li><p><font color=red>先获取缓存中保存的单实例Bean</font>。如果能获取到说明这个Bean之前被创建过（所有创建过的单实例Bean都会被缓存起来）</p>
</li>
<li><p>标记当前bean已经被创建，防止多线程对bean进行了创建，保持其单例的特性</p>
</li>
<li><p>获取Bean的定义信息</p>
</li>
<li><p><font color=red>获取当前Bean依赖的其他Bean；如果有，按照getBean()把依赖的Bean先创建出来</font></p>
</li>
<li><p>启动单实例Bean的创建流程：</p>
<ol>
<li><p>createBean(beanName.mbd,args)</p>
</li>
<li><p>Object bean = resolveBeforeInstantiation(beanName,mbdToUser) </p>
<p><font color=red>让BeanPostProcessor拦截返回代理对象</font></p>
<p>【InstantiationAwareBeanPostProcessor】提前执行</p>
<p>先触发：postProcessBeforeInstantiation()</p>
<p>如果有返回值：触发PostProcessorAfterInitialization()</p>
</li>
<li><p>如果前面的InstantiationAwareBeanPostProcessor没有返回代理对象，调用4</p>
</li>
<li><p>Object beanInstance = doCreateBean(beanName,mbdToUse,args);创建Bean</p>
<ol>
<li><p>【创建Bean实例】，createBeanInstance(beanName,mbd,args)</p>
<p>利用工厂方法或者对象的构造器创建出Bean实例</p>
</li>
<li><p>applyMergedBeanDefinitionPostProcessors(mbd,beanType,beanName)</p>
<p>调用MergedBeanDefinitionPostProcessor的postProcessMergedBeanDefinition</p>
</li>
<li><p>【Bean属性赋值】 populateBean（beanName,mbd,instanceWrapper)；</p>
<p>赋值之前：</p>
<ol>
<li><p>拿到InstantiationAwareBeanPostProcessor后置处理器</p>
<p>PostProcessAfterInstantiation();</p>
</li>
<li><p>拿到InstantiationAwareBeanPostProcess后置处理器</p>
<p>postProcessPropertyValues();</p>
<p>——–赋值之前————</p>
</li>
<li><p>应用Bean属性的值</p>
<p>为属性利用setter方法等进行赋值</p>
<p>applyPropertyValues(beanName,mbd,bw,pvs)</p>
</li>
</ol>
</li>
<li><p>【Bean初始化】initializeBean(beanName,exposedObject,mbd)</p>
<ol>
<li><p>【执行Aware接口方法】invokeAwareMethods(beanName,bean);执行xxxxAware接口的方法</p>
<p>BeanNameAware、BeanClassLoaderAware、BeanFactoryAware</p>
</li>
<li><p>【执行后置处理器初始化之前】applyBeanPostProcessorsBeforeInitialization(wrappedBean,beanName)</p>
<p>BeanPostProcessor.postProcessBeforeInitialization()</p>
</li>
<li><p>【执行初始化方法】invokeInitMethods(beanName,wrappedBean,mbd)</p>
<ol>
<li>是否是InitializatingBean接口的实现；执行接口规定的初始化</li>
<li>是否有自定义初始化的方法，有则执行</li>
</ol>
</li>
<li><p>【执行后置处理器初始化之后】applyBeanPostProcessorsAfterInitialization</p>
<p>BeanPostProcessor.postProcessAfterInitialization()</p>
</li>
<li><p>注册Bean的销毁方法</p>
</li>
</ol>
</li>
<li><p>将创建的Bean添加到缓存中的singletonObjects</p>
<p><font color=red>ioc容器就是这些Map，Map里面保存了单实例Bean、环境信息等等</font></p>
</li>
</ol>
</li>
</ol>
</li>
<li><p>所有Bean都利用getBean创建完成以后</p>
<p>检查所有的Bean是否是SmartInitializalizingSingleton接口的</p>
<p>如果是就执行afterSingletonsInstantiated()方法</p>
<img src="https://gitee.com/CooperXJ/blog-map-bed/raw/master/img/20210402093002.png" alt="image-20210402092956671" style="zoom:50%;" /></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<hr>
<h4 id="finishRefresh-完成BeanFactory的初始化创建工作，IOC容器创建完成"><a href="#finishRefresh-完成BeanFactory的初始化创建工作，IOC容器创建完成" class="headerlink" title="finishRefresh() 完成BeanFactory的初始化创建工作，IOC容器创建完成"></a>finishRefresh() 完成BeanFactory的初始化创建工作，IOC容器创建完成</h4><ol>
<li><p>initLifecycleProcessor（） 初始化和生命周期有关的后置处理器：LifecycleProcessor</p>
<p>默认从容器中找是否有LifecycleProcessor的组件【LifecycleProcessor】</p>
<p>如果没有则new DefaultLifecycleProcessor，加入到容器中</p>
<p>写一个LifecycleProcessor的实现类，可以在BeanFactory</p>
<p>void onRefresh（）</p>
<p>void onClose()</p>
<p>这些生命周期时对该实现类的方法进行调用</p>
</li>
<li><p>getLifeCycleProcessor().onRefresh()</p>
<p>拿到前面定义的生命周期处理器（BeanFactory）回调onRefresh()</p>
</li>
<li><p>publishEvent(new ContextRefreshdEvent(this));发布容器刷新完成事件</p>
</li>
<li><p>liveBeansView.registerApplicationContext(this);</p>
</li>
</ol>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ol>
<li><p>spring容器在启动的时候，会先保存所有注册进来的Bean的定义信息</p>
<ul>
<li><p>xml注册bean</p>
</li>
<li><p>注解注册bean；@Service、@Bean、@Component</p>
</li>
</ul>
</li>
<li><p>spring容器会在合适的时机创建这些Bean</p>
<ul>
<li>用到这个Bean的时候，利用getBean创建Bean，创建好以后保存在容器中</li>
<li>统一创建所有剩下bean的时候，finishBeanFactoryInitialization()</li>
</ul>
</li>
<li><p>后置处理器 BeanPostProcessor</p>
<ol>
<li><p>每一个Bean创建完成，都会使用各种后置处理器进行处理来增强Bean的功能</p>
<p>比如AutowiredAnnotationBeanPostProcessor、AnnotationAwareAspectJAutoProxyCreator来做AOP<br>功能</p>
</li>
</ol>
</li>
<li><p>事件驱动模型</p>
<p>ApplicationListener：事件监听</p>
<p>ApplicationEventMulticaster：事件派发</p>
</li>
</ol>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://cooperxj.github.io/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/IOC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cooper">
      <meta itemprop="description" content="记录一些学习笔记、小说、随笔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cooper Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/IOC/" class="post-title-link" itemprop="url">IOC</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-07 08:43:47" itemprop="dateCreated datePublished" datetime="2022-01-07T08:43:47+08:00">2022-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-01-17 18:14:59" itemprop="dateModified" datetime="2022-01-17T18:14:59+08:00">2022-01-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/IOC/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/07/Spring%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/spring%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/IOC/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="IOC"><a href="#IOC" class="headerlink" title="IOC"></a>IOC</h1><h3 id="IOC容器的职责"><a href="#IOC容器的职责" class="headerlink" title="IOC容器的职责"></a>IOC容器的职责</h3><ul>
<li><p>通用职责</p>
<ul>
<li>依赖处理<ul>
<li>依赖查找</li>
<li>依赖注入</li>
</ul>
</li>
</ul>
<p>两者区别            </p>
<table>
<thead>
<tr>
<th>类型</th>
<th>依赖处理</th>
<th>实现便利性</th>
<th>代码侵入性</th>
<th>API 依赖性</th>
<th>可读性</th>
</tr>
</thead>
<tbody><tr>
<td>依赖查找</td>
<td>主动获取</td>
<td>相对繁琐</td>
<td>侵入业务逻辑</td>
<td>依赖容器API</td>
<td>良好</td>
</tr>
<tr>
<td>依赖注入</td>
<td>被动提供</td>
<td>相对便利</td>
<td>低侵入性</td>
<td>不依赖容器API</td>
<td>一般</td>
</tr>
</tbody></table>
<ul>
<li>生命周期管理<ul>
<li>容器</li>
<li>托管的资源（Java Beans或者其他资源）</li>
</ul>
</li>
<li>配置<ul>
<li>容器</li>
<li>外部化配置</li>
<li>托管的资源（Java Beans或者其他资源）</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="ComponentScan"><a href="#ComponentScan" class="headerlink" title="@ComponentScan"></a>@ComponentScan</h3><ul>
<li><p>excludeFilers  = Filter[] 指定扫描的时候按照什么规则排除哪些组件</p>
</li>
<li><p>includeFilers  = Filter[] 指定扫描的时候只需要包含哪些组件</p>
</li>
<li><p>FIlterType.ANNOTATION 按照注释</p>
</li>
<li><p>FilerType.ASSIGNABLE_TYPE 按照给定的类型</p>
</li>
<li><p>FilterType.ASPECTJ 使用ASPECTJ表达式</p>
</li>
<li><p>FilterType.REGEX 使用正则指定</p>
</li>
<li><p>FilterType.CUSTOM 使用自定义规则</p>
<p>这个需要自己编写一个类继承TypeFilter（这个类不需要加上注解@Component）</p>
</li>
</ul>
<h3 id="Scope"><a href="#Scope" class="headerlink" title="@Scope"></a>@Scope</h3><ul>
<li><p>prototype 多实例的 <font color=red>ioc容器启动并不会去调用方法创建对象放在容器中，每次获取的时候才会调用方法创建对象</font></p>
</li>
<li><p>singleton 单实例的（默认值）<font color=red>ioc容器启动会调用方法创建对象放到ioc容器中，以后每次获取就会直接从容器中（map.get）中拿</font></p>
<p>@Lazy 懒加载 仅在单实例下生效，当调用时才会进行创建然后加载</p>
</li>
<li><p>request 同一次请求创建一个实例 （很少用）</p>
</li>
<li><p>session 同一个session创建一个实例 （很少用）</p>
</li>
</ul>
<h3 id="Conditional"><a href="#Conditional" class="headerlink" title="@Conditional"></a>@Conditional</h3><p>可以在方法或者类上进行使用，与此同时需要编写一个实现Condition（spring中的一个注解类）的类从而实现条件判断获取bean</p>
<h3 id="给容器注册组件"><a href="#给容器注册组件" class="headerlink" title="给容器注册组件"></a>给容器注册组件</h3><ol>
<li><p>包扫描+组件标注注解（@Controller/@Service/@Repository/@Component）</p>
</li>
<li><p>@Bean 导入第三方包里面的组件</p>
</li>
<li><p>@Import 快速给容器中导入一个组件</p>
<ol>
<li><p>@Import，容器就会自动注册这个组件，id默认是全类名</p>
</li>
<li><p>ImportSelector（需要实现该接口）：返回需要导入的组件的全类名数组（如果没有类需要导入，但是使用了实现该类的接口，需要返回一个空数组，如果返回一个null会直接报错）</p>
<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210326092003.png" alt="image-20210326092000953"></p>
</li>
<li><p>ImportBeanDefinitionRegistrar ：手动注册bean到容器中</p>
<p>需要实现ImportBeanDefinitionRegistrar该类的方法</p>
<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210326092101.png" alt="image-20210326092100293"></p>
</li>
</ol>
</li>
<li><p>使用spring提供的FactoryBean，实现该类的方法</p>
<p>其中实现的两个方法：</p>
<ul>
<li><p>getObject（）</p>
<p>返回一个对象，该对象会添加到容器中</p>
</li>
<li><p>getObjectType()</p>
<p>返回对象的类型</p>
</li>
<li><p>isSingleton（）</p>
<p>返回是否为单例，如果为True，则返回单例，否则是prototype</p>
</li>
</ul>
<ol>
<li>默认获取到的是工厂bean调用getObject的对象</li>
<li>要获取factoryBean本身，我们需要给id前加一个”&amp;“</li>
</ol>
</li>
</ol>
<h3 id="指定-Bean的初始化和销毁方法"><a href="#指定-Bean的初始化和销毁方法" class="headerlink" title="指定@Bean的初始化和销毁方法"></a>指定@Bean的初始化和销毁方法</h3><ol>
<li><p>指定@Bean的初始化和销毁方法</p>
<img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210323142348.png" alt="image-20210323142335194" style="zoom:50%;" />

<p>单实例的bean容器关闭的时候调用destroyMethod方法</p>
<p>多实例的时候容器不会管理该bean</p>
</li>
<li><p>也可以直接在需要注册到容器中的类实现InitializingBean和DisposableBean接口从而完成类的初始化和销毁方法</p>
<p>此处的InitializingBean接口中实现的方法触发的时机是当所有的properties赋好值完了之后才会进行调用</p>
</li>
<li><p>在类中使用@PostConstruct和@PreDestroy</p>
<p>@PostConstruct注解的方法是在对象创建并赋值之后调用</p>
</li>
<li><p>BeanPostProcessor：bean的后置处理器  需要实现BeanPostProcessor该接口</p>
<p>在bean初始化之前进行一些处理工作</p>
<p>postProcessBeforeInitialization：在初始化之前工作，<font color=red>但是实际上在赋值之后初始化之前调用</font></p>
<p>postProcessAfterInitialization：在初始化之后工作</p>
<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210323145823.png" alt="image-20210323145816702"></p>
</li>
</ol>
<p><font color=red>BeanPostProcessor这个接口非常重要</font>，是spring中其他一些注解的接口，其他注解比如@Async、@PostConstruct等都是实现了该接口的方法来实现的对应功能</p>
<h3 id="Properties"><a href="#Properties" class="headerlink" title="@Properties"></a>@Properties</h3><p>SpringBoot可以识别两种格式的配置文件，分别是yml文件与properties文件，我们可以将application.properties文件换成application.yml，这两个文件都可以被SpringBoot自动识别并加载.</p>
<p>application.properties配置文件欲被SpringBoot自动加载，需要放置到指定的位置：src/main/resource目录下，一般自定义的配置文件也位于此目录之下。需要在启动类上添加上@PropertySource(value = {“classpath:/xxxx.yaml”})</p>
<h3 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a>@Autowired</h3><ol>
<li><p>默认优先按照类型去容器中找对应的组件：application.getBean()</p>
</li>
<li><p>如果找到多个类型相同的组件，再将属性的名称作为组件的id去容器中查找</p>
</li>
<li><p>@Qualifier(“bookDao”) 使用@Qualifier指定需要装配的组件id，而不是使用属性名</p>
</li>
<li><p>自动装配默认一定要将属性赋值好，没有就会报错，意思就是容器中本身就没有需要Autowired的组件</p>
<p>可以使用@Autowired(required=false)</p>
</li>
<li><p>@Primary：让Spring进行自动装配的时候，默认使用首选的bean，也可以继续使用@Qualifier指定需要装配的bean的名字</p>
</li>
</ol>
<p>@Autowired：构造器、参数、方法、属性：都是从容器中获取参数组件的值</p>
<ul>
<li><p>标注在方法位置</p>
<p>@Bean+方法参数，参数从容器中获取，默认不写@Autowired效果是一样的，比如下图中的Car就可以不使用@Autowired进行标注，也会自动装入 </p>
<img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210324110835.png" alt="image-20210324110829858" style="zoom:50%;" /></li>
<li><p>标在构造器上</p>
<p>如果组件只有一个有参构造器，这个有参构造器的@Autowired可以省略，参数位置的组件依旧可以自动从容器中获取</p>
</li>
<li><p>放在参数位置</p>
</li>
<li><p><font color=red>如果没有构造器的话，默认会加载无参构造器，如果你里面依旧有其他需要注入的参数组件，但是对应的参数组件又没有Autowired标识，那么是不会进行自动装配的</font>。</p>
</li>
</ul>
<h3 id="Resource-Inject"><a href="#Resource-Inject" class="headerlink" title="@Resource @Inject"></a>@Resource @Inject</h3><ol>
<li><p>@Resource  (JSR250)</p>
<p>可以和@Autowired一样实现自动装配部的功能，默认是按照组件名称进行装配的</p>
<p>没有能支持@Primary功能</p>
<p>没有能支持@Autowired(required=false)</p>
</li>
<li><p>@Inject （JSR330）</p>
<p>需要导入javax.inject的包,和Autowired的功能一样，没有required=false的功能</p>
</li>
<li><p>和@Autowired的区别</p>
<p>@Inject和@Resource是java规范,@Autowired是Spring定义的</p>
</li>
</ol>
<h3 id="自定义组件使用Spring容器底层的一些组价（ApplicationContext、BeanFactory、xxx）"><a href="#自定义组件使用Spring容器底层的一些组价（ApplicationContext、BeanFactory、xxx）" class="headerlink" title="自定义组件使用Spring容器底层的一些组价（ApplicationContext、BeanFactory、xxx）"></a>自定义组件使用Spring容器底层的一些组价（ApplicationContext、BeanFactory、xxx）</h3><p>自定义组件实现xxxxAware：在创建对象 的时候会调用接口规定的方法注入相关组件</p>
<p>把srping底层一些组件注入到自定义的Bean中:</p>
<p>xxxxAware:功能使用xxxxProcessor:</p>
<p>​    ApplicationContextAware==&gt;ApplicationContextWaareProcessor</p>
<h3 id="Profile"><a href="#Profile" class="headerlink" title="@Profile"></a>@Profile</h3><p>指定组件在哪个环境的情况下才能被注册到容器中，不指定任何环境在都能注册这个组件</p>
<ul>
<li>加了环境标识的bean，只有在这个环境被激活的时候才能注册到容器中，默认是default环境</li>
<li>写在配置类上只有在制定的环境的时候，整个配置类里面的所有配置才能开始生效</li>
<li>没有标注环境标识的bean在任何环境下都是加载的</li>
</ul>
<p>设置applicationContext的运行环境</p>
<ol>
<li><p>命令行参数启动</p>
</li>
<li><p>代码启动 </p>
<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210324113748.png" alt="image-20210324113746729"></p>
<p>此处一定要注意，不能是直接写AnnotationConfigApplicationContext application = new AnnotationConfigApplicationContext(xxxx.class) (xxxx.class为配置类)</p>
<p>因为它会自动执行自己的方法</p>
<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210324113928.png" alt="image-20210324113927243"></p>
<p>环境啥的都没有配置好，导致直接refresh()容器，其实最主要的就是需要设置一个激活的环境，也就是</p>
<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20210324114020.png" alt="image-20210324114016821"></p>
</li>
</ol>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://cooperxj.github.io/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cooper">
      <meta itemprop="description" content="记录一些学习笔记、小说、随笔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cooper Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">模式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-07 08:43:47" itemprop="dateCreated datePublished" datetime="2022-01-07T08:43:47+08:00">2022-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-13 09:05:59" itemprop="dateModified" datetime="2021-02-13T09:05:59+08:00">2021-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式 - 行为模式</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E5%BC%8F/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E5%BC%8F/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="责任链模式"><a href="#责任链模式" class="headerlink" title="责任链模式"></a>责任链模式</h4><h5 id="本质"><a href="#本质" class="headerlink" title="本质"></a>本质</h5><p>​    将能够处理同一请求的对象连成一条链，所提交的请求沿着链进行传递，如果链上的某个节点无法处理则提交给下一个节点，如果依然无法处理该请求则依次向后传递。</p>
<h5 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h5><pre><code>- 打牌时轮流出牌
- 接力赛跑
- 奖学金的审批
- 公司公文的审批
</code></pre>
<p><strong><font color = red>类似于链表</font></strong></p>
<hr>
<h4 id="迭代器模式"><a href="#迭代器模式" class="headerlink" title="迭代器模式"></a>迭代器模式</h4><h5 id="本质-1"><a href="#本质-1" class="headerlink" title="本质"></a>本质</h5><p>​    java里面的迭代器组件：List/set</p>
<hr>
<h4 id="中介者模式"><a href="#中介者模式" class="headerlink" title="中介者模式"></a>中介者模式</h4><h5 id="本质-2"><a href="#本质-2" class="headerlink" title="本质"></a>本质</h5><p>​    解耦多个同事之间的交互关系。每个对象都持有中介者对象的引用，只跟中介者对象打交道。我们通过中介者统一管理这些交互关系。</p>
<h5 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h5><p>​    公司部门中的多个部门：财务部，研发部，市场部。如果这些直接进行打交道就会混乱，因此需要总经理对几个部门之间进行协调，总经理就类似于中介者。</p>
<h5 id="常见场景"><a href="#常见场景" class="headerlink" title="常见场景"></a>常见场景</h5><pre><code>- MVC模式中的C
- java反射中的Method.invoke()
</code></pre>
<hr>
<h4 id="命令模式"><a href="#命令模式" class="headerlink" title="命令模式"></a>命令模式</h4><h5 id="本质-3"><a href="#本质-3" class="headerlink" title="本质"></a>本质</h5><p>​    将一个请求封装为一个对象，从而可以使我们不同的请求对客户进行参数化。对请求排队或者记录请求日志，以及支持可撤销的操作。</p>
<h5 id="实现结构"><a href="#实现结构" class="headerlink" title="实现结构"></a>实现结构</h5><p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20200716153025.png" alt="image-20200716153013483"></p>
<h5 id="常用场景"><a href="#常用场景" class="headerlink" title="常用场景"></a>常用场景</h5><pre><code>- 数据库事务机制的底层实现
- 命令的撤销与恢复
</code></pre>
<hr>
<h4 id="解释器模式"><a href="#解释器模式" class="headerlink" title="解释器模式"></a>解释器模式</h4><h5 id="本质-4"><a href="#本质-4" class="headerlink" title="本质"></a>本质</h5><p>​    解析特殊的语言的设计模式</p>
<p>​    使用较少</p>
<hr>
<h4 id="访问者模式"><a href="#访问者模式" class="headerlink" title="访问者模式"></a>访问者模式</h4><h5 id="本质-5"><a href="#本质-5" class="headerlink" title="本质"></a>本质</h5><p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20200716153905.png" alt="image-20200716153903842"></p>
<hr>
<h4 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h4><h5 id="本质-6"><a href="#本质-6" class="headerlink" title="本质"></a>本质</h5><p>​    分离算法，选择实现。</p>
<p>​    对应于解决某一个问题的算法族，允许用户从该算法族中任选一个算法解决某一问题，同时可以方便的更换算法或者增加新的算法，并由客户决定调用哪个算法。</p>
<hr>
<h4 id="模板方法模式"><a href="#模板方法模式" class="headerlink" title="模板方法模式"></a>模板方法模式</h4><h5 id="本质-7"><a href="#本质-7" class="headerlink" title="本质"></a>本质</h5><p>​        实现一个算法时步骤很固定，但是某些部分很容易发生改变，易变部分可以抽象出来，供子类实现    </p>
<h5 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h5><ul>
<li>数据库访问的封装</li>
<li>Junit单元测试</li>
<li>servlet中doGet/doPost调用</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BankTemplateMethod</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">takeNumber</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;取号...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">transact</span><span class="params">()</span></span>;<span class="comment">//具体业务，钩子方法</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">evaluate</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;反馈评分...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">()</span><span class="comment">//不可以修改 因为是一个骨架，是固定的流程</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.takeNumber();</span><br><span class="line">        <span class="keyword">this</span>.transact();</span><br><span class="line">        <span class="keyword">this</span>.evaluate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="状态模式"><a href="#状态模式" class="headerlink" title="状态模式"></a>状态模式</h4><h5 id="本质-8"><a href="#本质-8" class="headerlink" title="本质"></a>本质</h5><p>​    用于解决系统中复杂对象的状态转换以及不同状态下行为的封装问题</p>
<p>​    </p>
<h5 id="实现结构-1"><a href="#实现结构-1" class="headerlink" title="实现结构"></a>实现结构</h5><ul>
<li>Context环境类<pre><code>    - 环境类中维护一个State对象，他定义了当前的状态
</code></pre>
</li>
<li>State抽象类</li>
<li>ConcentrateState具体状态类<ul>
<li>每一个类封装了一个状态对应的行为</li>
</ul>
</li>
</ul>
<hr>
<h4 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h4><h5 id="本质-9"><a href="#本质-9" class="headerlink" title="本质"></a>本质</h5><p>​    让观察者能够及时了解到对象发生的变化。（1：N）</p>
<p>​    有两种方式：</p>
<pre><code>        - 推  对象主动向观察者发送新的状态

    -  拉  观察者主动获取对象的状态
</code></pre>
<h5 id="使用场景-1"><a href="#使用场景-1" class="headerlink" title="使用场景"></a>使用场景</h5><pre><code>- 聊天室
- 网络游戏
- 邮件订阅
- Servlet监听器实现
- Android中广播机制
- 京东商城群发商品打折信息
</code></pre>
<hr>
<h4 id="备忘录模式"><a href="#备忘录模式" class="headerlink" title="备忘录模式"></a>备忘录模式</h4><h5 id="本质-10"><a href="#本质-10" class="headerlink" title="本质"></a>本质</h5><p>​    保存某个对象内部状态的拷贝，以便出问题时后期及时恢复到先前的状态</p>
<p>​    </p>
<h5 id="实现结构-2"><a href="#实现结构-2" class="headerlink" title="实现结构"></a>实现结构</h5><p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20200717102504.png" alt="image-20200717102503333"></p>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://cooperxj.github.io/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cooper">
      <meta itemprop="description" content="记录一些学习笔记、小说、随笔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cooper Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">单例模式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-07 08:43:47" itemprop="dateCreated datePublished" datetime="2022-01-07T08:43:47+08:00">2022-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-13 09:04:11" itemprop="dateModified" datetime="2021-02-13T09:04:11+08:00">2021-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式 - 创建型模式</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>核心作用</strong></p>
<pre><code>- 保证一个类只有一个实例，并提供一个访问该实例的全局访问点
</code></pre>
<p><strong>优点</strong></p>
<pre><code>- 减少系统性能开销
</code></pre>
<ul>
<li>在系统设置全局访问点，优化共享资源访问 </li>
</ul>
<p>常见的五种单例模式实现方式：</p>
<ul>
<li><p>主要</p>
<ul>
<li><p>饿汉式（线程安全，调用效率高，不能延时加载）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonDemo01</span> </span>&#123;</span><br><span class="line">    <span class="comment">//当该类进行初始化时就加载该对象，类加载时是天然安全的,但是同时也就无法进行延时加载</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SingletonDemo01 s = <span class="keyword">new</span> SingletonDemo01();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SingletonDemo01</span><span class="params">()</span></span>&#123;&#125;<span class="comment">//保证其他人创建不了该类的实例</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//方法无需使用同步，故效率高</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SingletonDemo01 <span class="title">getInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>懒汉式（线程安全、调用效率不高，可以延时加载）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonDemo02</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SingletonDemo02 s;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SingletonDemo02</span><span class="params">()</span></span>&#123;&#125;<span class="comment">//保证其他人创建不了该类的实例</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//方法用同步，故效率低这里添加同步关键字是为了防止多线程访问</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> SingletonDemo02 <span class="title">getInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(s==<span class="keyword">null</span>)</span><br><span class="line">            s = <span class="keyword">new</span> SingletonDemo02();</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<ul>
<li><p>其他</p>
<ul>
<li><p>双重检测锁模式（由于JVM底层内部模型，偶尔会出现问题，不建议使用）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonDemo04</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SingletonDemo04 s  = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SingletonDemo04</span><span class="params">()</span></span>&#123;&#125;<span class="comment">//保证其他人创建不了该类的实例</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//保证第一次加载时使用同步关键字，之后就不再使用同步了</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  SingletonDemo04 <span class="title">getInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(s==<span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            SingletonDemo04 s1;</span><br><span class="line">            <span class="keyword">synchronized</span> (SingletonDemo04.class)</span><br><span class="line">            &#123;</span><br><span class="line">                s1 = s;</span><br><span class="line">                <span class="keyword">if</span>(s1==<span class="keyword">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">synchronized</span> (SingletonDemo04.class)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">if</span>(s1==<span class="keyword">null</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            s1 = <span class="keyword">new</span> SingletonDemo04();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    s = s1;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>静态内部类式（线程安全，调用效率高并且可以延时加载）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    静态内部类实现单例模式</span></span><br><span class="line"><span class="comment">    这样的话可以综合需要时才加载并且效率高不需要使用同步代码块的问题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonDemo03</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SingletonDemo03</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//静态内部类 只有调用了getInstance()时才会初始化对象 因此不会出现多线程安全问题 并且没有同步所以效率高</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonInstance</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> SingletonDemo03 instance = <span class="keyword">new</span> SingletonDemo03();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SingletonDemo03 <span class="title">getInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonInstance.instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>枚举单例（线程安全，调用效率高，不能延时加载，并且可以防止放射或反序列话的漏洞）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    枚举实现单例模式</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span>  <span class="title">SingletonDemo05</span> </span>&#123;</span><br><span class="line">    <span class="comment">//该元素本身就是单例</span></span><br><span class="line">    INSTANCE;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//操作方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operation</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h6 id="如何选择？"><a href="#如何选择？" class="headerlink" title="如何选择？"></a>如何选择？</h6><p>不需要延时加载：</p>
<p>​    枚举好于饿汉式</p>
<p>需要延时加载：</p>
<p>​    静态内部类好于懒汉式</p>
<p>常见的应用常见：</p>
<ul>
<li>windows的任务管理器</li>
<li>网站计数器</li>
<li>应用程序的日志</li>
<li>数据库的连接池设计</li>
<li>  操作系统的文件系统</li>
<li>Spring中的Bean</li>
<li>Servlet编程中每个Servlet</li>
<li>Spring MVC中控制器对象</li>
</ul>
<p>效率：</p>
<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20200713222648.png" alt="image-20200713221811174"></p>
<h5 id="常见的问题以及解决措施"><a href="#常见的问题以及解决措施" class="headerlink" title="常见的问题以及解决措施"></a>常见的问题以及解决措施</h5><p>问题：</p>
<ul>
<li><p>反射</p>
<p> 解决措施：</p>
<ul>
<li><p> 通过计数器判断是否新创建了类</p>
</li>
<li><p>判断类中的成员是否为空，若不为空则抛出异常（该解决措施还是存在一些问题的，特别是没有getInstance（）的情况下直接利用发射，会导致失效）</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="title">SingletonDemo06</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//        if(s!=null)//防止利用反射调用该方法</span></span><br><span class="line"><span class="comment">//            throw new RuntimeException();</span></span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span>(count&gt;<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="comment">//保证其他人创建不了该类的实例</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
<li><p>反序列化获得类</p>
<p>解决措施：</p>
<ul>
<li><p>添加该方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在单例模式的类中添加该方法可以使得反序列化时获得的类是原来已经创建的类</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Object <span class="title">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://cooperxj.github.io/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cooper">
      <meta itemprop="description" content="记录一些学习笔记、小说、随笔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cooper Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">原型模式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-07 08:43:47" itemprop="dateCreated datePublished" datetime="2022-01-07T08:43:47+08:00">2022-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-13 09:04:26" itemprop="dateModified" datetime="2021-02-13T09:04:26+08:00">2021-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式 - 创建型模式</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>671</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="本质"><a href="#本质" class="headerlink" title="本质"></a>本质</h5><ul>
<li><p> 通过new产生一个对象比较繁琐，因为需要一行行代码的执行</p>
</li>
<li><p> java中的clone方法以某个对象为原型，直接复制该对象的所有数据，然后根据自己想要在该克隆对象的基础上进行修改得到最终的对象</p>
</li>
<li><p>与new不同之处在于：</p>
<p> new是赋值默认值，但是clone的对象的属性与原型保持一致，并且克隆出的对象不会影响原来的对象</p>
</li>
</ul>
<hr>
<h5 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h5><p>​    实现Cloneable接口和clone方法</p>
<hr>
<p><strong><font color = red>注意深拷贝和浅拷贝的区别</font></strong></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/JamesWang1993/p/8526104.html">深拷贝和浅拷贝的区别</a></p>
<p>有以下几个注意点：</p>
<ul>
<li>实现深拷贝需要重写clone方法，并且clone的类的属性需要继承Cloneable接口</li>
</ul>
<p>深拷贝可以利用反序列化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//利用反序列化实现深拷贝</span></span><br><span class="line">        ByteArrayOutputStream out = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        ObjectOutputStream objectOutputStream = <span class="keyword">new</span> ObjectOutputStream(out);</span><br><span class="line">        objectOutputStream.writeObject(sheep);</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = out.toByteArray();</span><br><span class="line"></span><br><span class="line">        ByteArrayInputStream in = <span class="keyword">new</span> ByteArrayInputStream(bytes);</span><br><span class="line">        ObjectInputStream objectInputStream = <span class="keyword">new</span> ObjectInputStream(in);</span><br><span class="line">        Sheep sheep2 = (Sheep) objectInputStream.readObject();</span><br></pre></td></tr></table></figure>



<hr>
<h5 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h5><p>需要短时间内创建大量的对象并且new的过程十分耗时，可以采用原型模式</p>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://cooperxj.github.io/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cooper">
      <meta itemprop="description" content="记录一些学习笔记、小说、随笔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cooper Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">工厂模式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-07 08:43:47" itemprop="dateCreated datePublished" datetime="2022-01-07T08:43:47+08:00">2022-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-13 09:04:21" itemprop="dateModified" datetime="2021-02-13T09:04:21+08:00">2021-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式 - 创建型模式</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>992</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h4><p>实现创建者和调用者的分离</p>
<hr>
<h4 id="核心本质"><a href="#核心本质" class="headerlink" title="核心本质"></a>核心本质</h4><p>实例化对象，用工厂方法代替new操作</p>
<p>将选择实现类、创建对象统一管理和控制。从而将调用者和我们的实现类解耦</p>
<hr>
<h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><ul>
<li><p>简单工厂模式（<font color=red>使用最多</font>）</p>
<p>用来生产同一等级结构中的任意产品。（对于新增加的产品需要修改原来的代码）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Car <span class="title">createCar</span><span class="params">(String type)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;奥迪&quot;</span>.equals(type))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Audi();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;比亚迪&quot;</span>.equals(type))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Byd();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>工厂方法模式</p>
<p>用来生产同一等级结构中的固定产品。（支持增加任意产品,弊端就是类会比较多，即在不修改已有类的前提下，增加新的工厂类实现扩展）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Car car1 = <span class="keyword">new</span> AudiFactory().createCar();</span><br><span class="line">        Car car2 = <span class="keyword">new</span> BydFactory().createCar();</span><br><span class="line"></span><br><span class="line">        car1.run();</span><br><span class="line">        car2.run();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>抽象工厂模式（<a target="_blank" rel="noopener" href="https://blog.csdn.net/yeyazhishang/article/details/95173103">参考</a>）</p>
<p>用来生产不同产品族的全部产品。（对于新增加的产品无能为力，但是支持增加产品族）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">      <span class="comment">//此处的Car、Engin都是接口</span></span><br><span class="line">        Car car1 =  <span class="keyword">new</span> LuxuryCar();</span><br><span class="line">        Engine e = car1.createEngine();</span><br><span class="line">        e.start();</span><br><span class="line">        </span><br><span class="line">        Car car2 = <span class="keyword">new</span> LowCar();</span><br><span class="line">        Engine engine = car2.createEngine();</span><br><span class="line">        engine.start();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20200714103151.png" alt="image-20200714103141807"></p>
<p>​    高端汽车是一个产品族</p>
<p>​    低端汽车也是一个产品族</p>
<p>​    对于单个产品的生产，比如单个发动机的生产可以直接使用简单工厂模式生产</p>
<p>​    对于整个产品族使用抽象工厂模式</p>
<p>如图所示：</p>
<img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20200714103648.png" alt="image-20200714103607340" style="zoom:50%;" /></li>
</ul>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://cooperxj.github.io/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cooper">
      <meta itemprop="description" content="记录一些学习笔记、小说、随笔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cooper Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">享元模式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-07 08:43:47" itemprop="dateCreated datePublished" datetime="2022-01-07T08:43:47+08:00">2022-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-12-15 09:28:08" itemprop="dateModified" datetime="2021-12-15T09:28:08+08:00">2021-12-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式 - 结构型模式</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>219</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="本质"><a href="#本质" class="headerlink" title="本质"></a>本质</h5><p>​    减少相同或者相似对象的数量从而节约内存空间。</p>
<p>​    比如说下围棋，黑子和白子，我只需要设计出两个类即所有黑子为一个对象，所有的白子为一个对象，不需要所有的棋子都生成对象。相同棋子外面不同的地方就在于棋子的位置不同，因此只需要保证内部状态（棋子的本质（颜色））共享，棋子的 外部状态（棋子的位置）不共享即可。</p>
<p>如图所示：</p>
<p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20200715222447.png" alt="image-20200715222445922"></p>
<hr>
<h5 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h5><p><img src="https://raw.githubusercontent.com/CooperXJ/ImageBed/master/img/20200715222523.png" alt="image-20200715222522494"></p>
<hr>
<h5 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h5><ul>
<li>任何与“池”有关的操作<pre><code>- 线程池
   - 数据库连接池
</code></pre>
</li>
<li>String类的设计<ul>
<li>常量的共享</li>
</ul>
</li>
</ul>
<hr>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p>​    节省了内存，但是时间运行变长了。</p>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://cooperxj.github.io/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Cooper">
      <meta itemprop="description" content="记录一些学习笔记、小说、随笔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cooper Notes">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">外观模式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-01-07 08:43:47" itemprop="dateCreated datePublished" datetime="2022-01-07T08:43:47+08:00">2022-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-13 09:05:19" itemprop="dateModified" datetime="2021-02-13T09:05:19+08:00">2021-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式 - 结构型模式</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2022/01/07/Java%E6%B2%89%E6%80%9D%E5%BD%95/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>48</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="本质"><a href="#本质" class="headerlink" title="本质"></a>本质</h5><p>​    为子系统提供统一的入口。封装子系统的复杂性，便于客户端的调用</p>
<p>说到底就是封装好对象供客户使用</p>

      
    </div>

    
    
    
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/35/">35</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Cooper</p>
  <div class="site-description" itemprop="description">记录一些学习笔记、小说、随笔</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">341</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">49</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">75</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/CooperXJ" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CooperXJ" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1789023580@qq.com" title="E-Mail → mailto:1789023580@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Cooper</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">648k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">9:49</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : 'rOzi1T6uncSYNdx0tp1owOzV-gzGzoHsz',
      appKey     : 'Fk3s6CQBK042e1QltClHnTBP',
      placeholder: "留下邮箱，有回复时你将收到提醒，邮箱不会被公开",
      avatar     : 'wavatar',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
